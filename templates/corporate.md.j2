# Rapporto di Sicurezza - Scansione Nmap

## Sommario Esecutivo

- Host analizzati: {{ data.stats.total if data.stats.total is defined else data.hosts | length }} 
- Host attivi (raggiungibili): {{ data.stats.up if data.stats.up is defined else data.hosts | length }}
{% if data.total_vulns and data.total_vulns > 0 -%}
- Vulnerabilità totali identificate: {{ data.total_vulns }}
- Distribuzione severità: 
  {% for sev, count in data.severity_counts.items() -%}
  **{{ sev }}**: {{ count }} {% if not loop.last %}|{% endif %}
  {% endfor -%}
{% else -%}
- Non sono state rilevate vulnerabilità note sugli host scansionati.
{% endif %}

## Dettaglio delle Risultanze

{% for host in data.hosts -%}
### Host: {{ host.ip }}{% if host.hostnames %} ({{ host.hostnames | join(', ') }}){% endif %}

{% if host.ports and host.ports | length > 0 -%}
{% for port in host.ports -%}
**Porta {{ port.port }}/{{ port.protocol }}** – {{ port.service }}{% if port.product %} ({{ port.product }} {{ port.version }}){% endif %}  
{% if port.vulns and port.vulns | length > 0 -%}
{% for vuln in port.vulns -%}
- **{{ vuln.cve }}** – CVSS: {{ "%.1f"|format(vuln.cvss) if vuln.cvss is not none else "N/D" }} ({{ vuln.severity or "Sconosciuta" }}){% if vuln.cwe %} – CWE: {{ vuln.cwe }}{% endif %}  
  **Raccomandazione:** {{ vuln.recommendation or "N/A" }}
{% endfor -%}
{% else -%}
- Nessuna vulnerabilità nota rilevata su questo servizio.
{% endif -%}

{% endfor -%}
{% else -%}
*(Nessuna porta aperta rilevata su questo host)*

{% endif -%}
{% endfor -%}
